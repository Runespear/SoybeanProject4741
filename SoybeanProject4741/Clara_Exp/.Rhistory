pred <- predict(nb_model, train5[,1:length(myvars)-1])
confusiontrain5 <-confusionMatrix(pred, reference = train5$GRAD, positive='yes')
confusiontrain1$table
confusiontrain2$table
confusiontrain3$table
confusiontrain4$table
confusiontrain5$table
confusiontrain1$overall['Accuracy']
confusiontrain2$overall['Accuracy']
confusiontrain3$overall['Accuracy']
confusiontrain4$overall['Accuracy']
confusiontrain5$overall['Accuracy']
setwd("C:/Users/User/Dropbox/SoybeanProject4741/Clara_Exp")
train1 <- read.csv("../Temp_Data/kmeans.csv")
train1<-train1[myvars]
str(train1)
train1$CHECK <- as.numeric(train1$CHECK)
str(train1)
clustermodel <- kmeans(train1[,1:dim(train1)[2]-1], 2, nstart = 20)
clustermodel
table(clustermodel$cluster, train1$GRAD)
install.packages("clue")
library(clue)
setwd("C:/Users/User/Dropbox/SoybeanProject4741/Clara_Exp")
data <- read.csv("../Temp_Data/kmeans.csv")
data<-data[myvars]
data$CHECK <- as.numeric(data$CHECK) # change to 1 and 0
str(data)
data("Cassini")
nr <- NROW(Cassini$x)
"Cassini"
ind <- sample(nr, 0.9 * nr, replace = FALSE)
party <- kmeans(Cassini$x[ind, ], 3)
table(cl_predict(party, Cassini$x[-ind, ]),
Cassini$classes[-ind])
Cassini
str(Cassini)
Cassini$x
Cassini$classes
ind
unique(Cassini$classes)
str(Cassini)
setwd("C:/Users/User/Dropbox/SoybeanProject4741/Clara_Exp")
#data <- read.csv("../Temp_Data/kmeans.csv")
train1 <- read.csv("../Split_Data2/training[1].csv")
train1 <- train1[myvars]
train1$GRAD <- as.factor(train1$GRAD)
train1$CHECK <- as.numeric(train1$CHECK) # change to 1 and 0
#train1$CLASS_OF <- as.factor(train1$CLASS_OF)
train2 <- read.csv("../Split_Data2/training[2].csv")
train2 <- train2[myvars]
train2$GRAD <- as.factor(train2$GRAD)
train2$CHECK <- as.numeric(train2$CHECK)
#train2$CLASS_OF <- as.factor(train2$CLASS_OF)
train3 <- read.csv("../Split_Data2/training[3].csv")
train3 <- train3[myvars]
train3$GRAD <- as.factor(train3$GRAD)
train3$CHECK <- as.numeric(train3$CHECK)
#train3$CLASS_OF <- as.factor(train3$CLASS_OF)
train4 <- read.csv("../Split_Data2/training[4].csv")
train4 <- train4[myvars]
train4$GRAD <- as.factor(train4$GRAD)
train4$CHECK <- as.numeric(train4$CHECK)
#train4$CLASS_OF <- as.factor(train4$CLASS_OF)
train5 <- read.csv("../Split_Data2/training[5].csv")
train5 <- train5[myvars]
train5$GRAD <- as.factor(train5$GRAD)
train5$CHECK <- as.numeric(train5$CHECK)
#train5$CLASS_OF <- as.factor(train5$CLASS_OF)
test1 <-read.csv("../Split_Data2/test_2010.csv")
test1 <- test1[myvars]
test1$GRAD <- as.factor(test1$GRAD)
test1$CHECK <- as.numeric(test1$CHECK)
#test1$CLASS_OF <- as.factor(test1$CLASS_OF)
test2 <-read.csv("../Split_Data2/test_2011.csv")
test2 <- test2[myvars]
test2$GRAD <- as.factor(test2$GRAD)
test2$CHECK <- as.numeric(test2$CHECK)
#test2$CLASS_OF <- as.factor(test2$CLASS_OF)
test3 <-read.csv("../Split_Data2/test_2012.csv")
test3 <- test3[myvars]
test3$GRAD <- as.factor(test3$GRAD)
test3$CHECK <- as.numeric(test3$CHECK)
#test3$CLASS_OF <- as.factor(test3$CLASS_OF)
test4 <-read.csv("../Split_Data2/test_2013.csv")
test4 <- test4[myvars]
test4$GRAD <- as.factor(test4$GRAD)
test4$CHECK <- as.numeric(test4$CHECK)
#test4$CLASS_OF <- as.factor(test4$CLASS_OF)
test5 <-read.csv("../Split_Data2/test_2014.csv")
test5 <- test5[myvars]
test5$GRAD <- as.factor(test5$GRAD)
test5$CHECK <- as.numeric(test5$CHECK)
#test5$CLASS_OF <- as.factor(test5$CLASS_OF)
cluster1 <- kmeans(train1[,1:dim(train1)[2]-1], 2, nstart = 20)
cluster1
table(clustermodel$cluster, train1$GRAD)
cluster1$cluster
cluster1$clusteringvector
cluster1$cluster
pred <-cluster1$cluster
train1 <- read.csv("../Split_Data2/training[1].csv")
new <- cbind (train1, pred)
write.csv(new, file = "kmeans1.csv")
getwd()
cluster2 <- kmeans(train2[,1:dim(train2)[2]-1], 2, nstart = 20)
pred <-cluster2$cluster
train2 <- read.csv("../Split_Data2/training[2].csv")
new <- cbind (train2, pred)
write.csv(new, file = "kmeans2.csv")
cluster3 <- kmeans(train3[,1:dim(train3)[2]-1], 2, nstart = 20)
pred <-cluster3$cluster
train3 <- read.csv("../Split_Data2/training[3].csv")
new <- cbind (train3, pred)
write.csv(new, file = "kmeans3.csv")
cluster4 <- kmeans(train4[,1:dim(train4)[2]-1], 2, nstart = 20)
pred <-cluster4$cluster
train4 <- read.csv("../Split_Data2/training[4].csv")
new <- cbind (train4, pred)
write.csv(new, file = "kmeans4.csv")
cluster5 <- kmeans(train5[,1:dim(train5)[2]-1], 2, nstart = 20)
pred <-cluster5$cluster
train5 <- read.csv("../Split_Data2/training[5].csv")
new <- cbind (train5, pred)
write.csv(new, file = "kmeans5.csv")
setwd("C:/Users/User/Dropbox/SoybeanProject4741/Clara_Exp")
myvars <- c("CHECK", "RM", "YIELD", "CLASS_ABSENT", "FAM_SEGMENT1", "FAM_SEGMENT2", "FAM_SEGMENT3", "FAM_SEGMENT4", "FAM_SEGMENT5", "GRAD")
train1 <- read.csv("../Split_Data2/training[1].csv")
train1 <- train1[myvars]
train1$GRAD <- as.factor(train1$GRAD)
train1$CHECK <- as.numeric(train1$CHECK) # change to 1 and 0
#train1$CLASS_OF <- as.factor(train1$CLASS_OF)
train2 <- read.csv("../Split_Data2/training[2].csv")
train2 <- train2[myvars]
train2$GRAD <- as.factor(train2$GRAD)
train2$CHECK <- as.numeric(train2$CHECK)
#train2$CLASS_OF <- as.factor(train2$CLASS_OF)
train3 <- read.csv("../Split_Data2/training[3].csv")
train3 <- train3[myvars]
train3$GRAD <- as.factor(train3$GRAD)
train3$CHECK <- as.numeric(train3$CHECK)
#train3$CLASS_OF <- as.factor(train3$CLASS_OF)
train4 <- read.csv("../Split_Data2/training[4].csv")
train4 <- train4[myvars]
train4$GRAD <- as.factor(train4$GRAD)
train4$CHECK <- as.numeric(train4$CHECK)
#train4$CLASS_OF <- as.factor(train4$CLASS_OF)
train5 <- read.csv("../Split_Data2/training[5].csv")
train5 <- train5[myvars]
train5$GRAD <- as.factor(train5$GRAD)
train5$CHECK <- as.numeric(train5$CHECK)
#train5$CLASS_OF <- as.factor(train5$CLASS_OF)
# test sets #
test1 <-read.csv("../Split_Data2/test_2010.csv")
test1 <- test1[myvars]
test1$GRAD <- as.factor(test1$GRAD)
test1$CHECK <- as.numeric(test1$CHECK)
#test1$CLASS_OF <- as.factor(test1$CLASS_OF)
test2 <-read.csv("../Split_Data2/test_2011.csv")
test2 <- test2[myvars]
test2$GRAD <- as.factor(test2$GRAD)
test2$CHECK <- as.numeric(test2$CHECK)
#test2$CLASS_OF <- as.factor(test2$CLASS_OF)
test3 <-read.csv("../Split_Data2/test_2012.csv")
test3 <- test3[myvars]
test3$GRAD <- as.factor(test3$GRAD)
test3$CHECK <- as.numeric(test3$CHECK)
#test3$CLASS_OF <- as.factor(test3$CLASS_OF)
test4 <-read.csv("../Split_Data2/test_2013.csv")
test4 <- test4[myvars]
test4$GRAD <- as.factor(test4$GRAD)
test4$CHECK <- as.numeric(test4$CHECK)
#test4$CLASS_OF <- as.factor(test4$CLASS_OF)
test5 <-read.csv("../Split_Data2/test_2014.csv")
test5 <- test5[myvars]
test5$GRAD <- as.factor(test5$GRAD)
test5$CHECK <- as.numeric(test5$CHECK)
#test5$CLASS_OF <- as.factor(test5$CLASS_OF)
# models #
cluster1 <- kmeans(train1[,1:dim(train1)[2]-1], 2, nstart = 20)
pred <-cluster1$cluster
train1 <- read.csv("../Split_Data2/training[1].csv")
new <- cbind (train1, pred)
write.csv(new, file = "kmeans1.csv")
cluster2 <- kmeans(train2[,1:dim(train2)[2]-1], 2, nstart = 20)
pred <-cluster2$cluster
train2 <- read.csv("../Split_Data2/training[2].csv")
new <- cbind (train2, pred)
write.csv(new, file = "kmeans2.csv")
cluster3 <- kmeans(train3[,1:dim(train3)[2]-1], 2, nstart = 20)
pred <-cluster3$cluster
train3 <- read.csv("../Split_Data2/training[3].csv")
new <- cbind (train3, pred)
write.csv(new, file = "kmeans3.csv")
cluster4 <- kmeans(train4[,1:dim(train4)[2]-1], 2, nstart = 20)
pred <-cluster4$cluster
train4 <- read.csv("../Split_Data2/training[4].csv")
new <- cbind (train4, pred)
write.csv(new, file = "kmeans4.csv")
cluster5 <- kmeans(train5[,1:dim(train5)[2]-1], 2, nstart = 20)
pred <-cluster5$cluster
train5 <- read.csv("../Split_Data2/training[5].csv")
new <- cbind (train5, pred)
write.csv(new, file = "kmeans5.csv")
cluster1 <- kmeans(train1[,1:dim(train1)[2]-1], 2, nstart = 20)
pred <-cluster1$cluster
train1 <- read.csv("../Split_Data2/training[1].csv")
new <- cbind (train1, pred)
write.csv(new, file = "kmeans1.csv")
cluster1 <- kmeans(train1[,1:dim(train1)[2]-1], 2, nstart = 20)
pred <-cluster1$cluster
train1 <- read.csv("../Split_Data2/training[1].csv")
new <- cbind (train1, pred)
write.csv(new, file = "kmeans1.csv")
cluster1 <- kmeans(train1[,1:dim(train1)[2]-1], 2, nstart = 20)
pred <-cluster1$cluster
train1 <- read.csv("../Split_Data2/training[1].csv")
new <- cbind (train1, pred)
write.csv(new, file = "kmeanstrain1.csv")
cluster2 <- kmeans(train2[,1:dim(train2)[2]-1], 2, nstart = 20)
pred <-cluster2$cluster
train2 <- read.csv("../Split_Data2/training[2].csv")
new <- cbind (train2, pred)
write.csv(new, file = "kmeanstrain2.csv")
cluster3 <- kmeans(train3[,1:dim(train3)[2]-1], 2, nstart = 20)
pred <-cluster3$cluster
train3 <- read.csv("../Split_Data2/training[3].csv")
new <- cbind (train3, pred)
write.csv(new, file = "kmeanstrain3.csv")
cluster4 <- kmeans(train4[,1:dim(train4)[2]-1], 2, nstart = 20)
pred <-cluster4$cluster
train4 <- read.csv("../Split_Data2/training[4].csv")
new <- cbind (train4, pred)
write.csv(new, file = "kmeanstrain4.csv")
cluster5 <- kmeans(train5[,1:dim(train5)[2]-1], 2, nstart = 20)
pred <-cluster5$cluster
train5 <- read.csv("../Split_Data2/training[5].csv")
new <- cbind (train5, pred)
write.csv(new, file = "kmeanstrain5.csv")
str(test1)
table(cl_predict(pred, test1[1:length(myvars)-1]),
Cassini$classes[-ind])
str(test1)
table(cl_predict(pred, test1[1:length(myvars)-1]), test1$GRAD)
str(test1)
str(train1)
train1 <- read.csv("../Split_Data2/training[1].csv")
train1 <- train1[myvars]
train1$GRAD <- as.factor(train1$GRAD)
train1$CHECK <- as.numeric(train1$CHECK) # change to 1 and 0
str(train1)
#train1$CLASS_OF <- as.factor(train1$CLASS_OF)
train2 <- read.csv("../Split_Data2/training[2].csv")
train2 <- train2[myvars]
train2$GRAD <- as.factor(train2$GRAD)
train2$CHECK <- as.numeric(train2$CHECK)
#train2$CLASS_OF <- as.factor(train2$CLASS_OF)
train3 <- read.csv("../Split_Data2/training[3].csv")
train3 <- train3[myvars]
train3$GRAD <- as.factor(train3$GRAD)
train3$CHECK <- as.numeric(train3$CHECK)
#train3$CLASS_OF <- as.factor(train3$CLASS_OF)
train4 <- read.csv("../Split_Data2/training[4].csv")
train4 <- train4[myvars]
train4$GRAD <- as.factor(train4$GRAD)
train4$CHECK <- as.numeric(train4$CHECK)
#train4$CLASS_OF <- as.factor(train4$CLASS_OF)
train5 <- read.csv("../Split_Data2/training[5].csv")
train5 <- train5[myvars]
train5$GRAD <- as.factor(train5$GRAD)
train5$CHECK <- as.numeric(train5$CHECK)
#train5$CLASS_OF <- as.factor(train5$CLASS_OF)
test1 <-read.csv("../Split_Data2/test_2010.csv")
test1 <- test1[myvars]
test1$GRAD <- as.factor(test1$GRAD)
test1$CHECK <- as.numeric(test1$CHECK)
#test1$CLASS_OF <- as.factor(test1$CLASS_OF)
test2 <-read.csv("../Split_Data2/test_2011.csv")
test2 <- test2[myvars]
test2$GRAD <- as.factor(test2$GRAD)
test2$CHECK <- as.numeric(test2$CHECK)
#test2$CLASS_OF <- as.factor(test2$CLASS_OF)
test3 <-read.csv("../Split_Data2/test_2012.csv")
test3 <- test3[myvars]
test3$GRAD <- as.factor(test3$GRAD)
test3$CHECK <- as.numeric(test3$CHECK)
#test3$CLASS_OF <- as.factor(test3$CLASS_OF)
test4 <-read.csv("../Split_Data2/test_2013.csv")
test4 <- test4[myvars]
test4$GRAD <- as.factor(test4$GRAD)
test4$CHECK <- as.numeric(test4$CHECK)
#test4$CLASS_OF <- as.factor(test4$CLASS_OF)
test5 <-read.csv("../Split_Data2/test_2014.csv")
test5 <- test5[myvars]
test5$GRAD <- as.factor(test5$GRAD)
test5$CHECK <- as.numeric(test5$CHECK)
#test5$CLASS_OF <- as.factor(test5$CLASS_OF)
cluster1 <- kmeans(train1[,1:dim(train1)[2]-1], 2, nstart = 20)
str(train1)
pred <-cluster1$cluster
table(cl_predict(pred, test1[1:length(myvars)-1]), test1$GRAD)
table(cl_predict(pred, test1, test1$GRAD)
table(cl_predict(pred, test1), test1$GRAD)
cluster2 <- kmeans(train2[,1:dim(train2)[2]-1], 2, nstart = 20)
table(cl_predict(pred, test1), test1$GRAD)
pred
str(pred)
table(cl_predict(cluster1, test1[1:length(myvars)-1]), test1$GRAD)
tabletrain1 <-table(cl_predict(cluster1, train1[1:length(myvars)-1]), train1$GRAD)
tabletest1 <-table(cl_predict(cluster1, test1[1:length(myvars)-1]), test1$GRAD)
tabletrain1
tabletrain1
tabletrain2
tabletrain3
tabletrain4
tabletrain5
tabletest1
tabletest2
tabletest3
tabletest4
tabletest5
cluster2 <- kmeans(train2[,1:dim(train2)[2]-1], 2, nstart = 20)
pred <-cluster2$cluster
train2 <- read.csv("../Split_Data2/training[2].csv")
new <- cbind (train2, pred)
write.csv(new, file = "kmeanstrain2.csv")
tabletrain2 <-table(cl_predict(cluster2, train2[1:length(myvars)-1]), train2$GRAD)
tabletest2 <-table(cl_predict(cluster2, test2[1:length(myvars)-1]), test2$GRAD)
cluster3 <- kmeans(train3[,1:dim(train3)[2]-1], 2, nstart = 20)
pred <-cluster3$cluster
train3 <- read.csv("../Split_Data2/training[3].csv")
new <- cbind (train3, pred)
write.csv(new, file = "kmeanstrain3.csv")
tabletrain3 <-table(cl_predict(cluster3, train3[1:length(myvars)-1]), train3$GRAD)
tabletest3 <-table(cl_predict(cluster3, test3[1:length(myvars)-1]), test3$GRAD)
cluster4 <- kmeans(train4[,1:dim(train4)[2]-1], 2, nstart = 20)
pred <-cluster4$cluster
train4 <- read.csv("../Split_Data2/training[4].csv")
new <- cbind (train4, pred)
write.csv(new, file = "kmeanstrain4.csv")
tabletrain4 <-table(cl_predict(cluster4, train4[1:length(myvars)-1]), train4$GRAD)
tabletest4 <-table(cl_predict(cluster4, test4[1:length(myvars)-1]), test4$GRAD)
cluster5 <- kmeans(train5[,1:dim(train5)[2]-1], 2, nstart = 20)
pred <-cluster5$cluster
train5 <- read.csv("../Split_Data2/training[5].csv")
new <- cbind (train5, pred)
write.csv(new, file = "kmeanstrain5.csv")
tabletrain5 <-table(cl_predict(cluster5, train5[1:length(myvars)-1]), train5$GRAD)
tabletest5 <-table(cl_predict(cluster5, test5[1:length(myvars)-1]), test5$GRAD)
tabletrain1
tabletrain2
tabletrain3
tabletrain4
tabletrain5
tabletest1
tabletest2
tabletest3
tabletest4
tabletest5
tabletrain2
tabletrain2 <-table(cl_predict(cluster2, train2[1:length(myvars)-1]), train2$GRAD)
cluster1 <- kmeans(train1[,1:dim(train1)[2]-1], 2, nstart = 20)
pred <-cluster1$cluster
tabletrain1 <-table(cl_predict(cluster1, train1[1:length(myvars)-1]), train1$GRAD)
tabletest1 <-table(cl_predict(cluster1, test1[1:length(myvars)-1]), test1$GRAD)
train1 <- read.csv("../Split_Data2/training[1].csv")
new <- cbind (train1, pred)
write.csv(new, file = "kmeanstrain1.csv")
cluster2 <- kmeans(train2[,1:dim(train2)[2]-1], 2, nstart = 20)
pred <-cluster2$cluster
tabletrain2 <-table(cl_predict(cluster2, train2[1:length(myvars)-1]), train2$GRAD)
tabletest2 <-table(cl_predict(cluster2, test2[1:length(myvars)-1]), test2$GRAD)
train2 <- read.csv("../Split_Data2/training[2].csv")
new <- cbind (train2, pred)
write.csv(new, file = "kmeanstrain2.csv")
cluster3 <- kmeans(train3[,1:dim(train3)[2]-1], 2, nstart = 20)
pred <-cluster3$cluster
tabletrain3 <-table(cl_predict(cluster3, train3[1:length(myvars)-1]), train3$GRAD)
tabletest3 <-table(cl_predict(cluster3, test3[1:length(myvars)-1]), test3$GRAD)
train3 <- read.csv("../Split_Data2/training[3].csv")
new <- cbind (train3, pred)
write.csv(new, file = "kmeanstrain3.csv")
cluster4 <- kmeans(train4[,1:dim(train4)[2]-1], 2, nstart = 20)
pred <-cluster4$cluster
tabletrain4 <-table(cl_predict(cluster4, train4[1:length(myvars)-1]), train4$GRAD)
tabletest4 <-table(cl_predict(cluster4, test4[1:length(myvars)-1]), test4$GRAD)
train4 <- read.csv("../Split_Data2/training[4].csv")
new <- cbind (train4, pred)
write.csv(new, file = "kmeanstrain4.csv")
cluster5 <- kmeans(train5[,1:dim(train5)[2]-1], 2, nstart = 20)
pred <-cluster5$cluster
tabletrain5 <-table(cl_predict(cluster5, train5[1:length(myvars)-1]), train5$GRAD)
tabletest5 <-table(cl_predict(cluster5, test5[1:length(myvars)-1]), test5$GRAD)
train5 <- read.csv("../Split_Data2/training[5].csv")
new <- cbind (train5, pred)
write.csv(new, file = "kmeanstrain5.csv")
tabletrain1
tabletrain2
tabletrain3
tabletrain4
tabletrain5
tabletest1
tabletest2
tabletest3
tabletest4
tabletest5
train1 <- read.csv("../Split_Data2/training[1].csv")
train1 <- train1[myvars]
train1$GRAD <- as.factor(train1$GRAD)
train1$CHECK <- as.numeric(train1$CHECK) # change to 1 and 0
#train1$CLASS_OF <- as.factor(train1$CLASS_OF)
train2 <- read.csv("../Split_Data2/training[2].csv")
train2 <- train2[myvars]
train2$GRAD <- as.factor(train2$GRAD)
train2$CHECK <- as.numeric(train2$CHECK)
#train2$CLASS_OF <- as.factor(train2$CLASS_OF)
train3 <- read.csv("../Split_Data2/training[3].csv")
train3 <- train3[myvars]
train3$GRAD <- as.factor(train3$GRAD)
train3$CHECK <- as.numeric(train3$CHECK)
#train3$CLASS_OF <- as.factor(train3$CLASS_OF)
train4 <- read.csv("../Split_Data2/training[4].csv")
train4 <- train4[myvars]
train4$GRAD <- as.factor(train4$GRAD)
train4$CHECK <- as.numeric(train4$CHECK)
#train4$CLASS_OF <- as.factor(train4$CLASS_OF)
train5 <- read.csv("../Split_Data2/training[5].csv")
train5 <- train5[myvars]
train5$GRAD <- as.factor(train5$GRAD)
train5$CHECK <- as.numeric(train5$CHECK)
#train5$CLASS_OF <- as.factor(train5$CLASS_OF)
test1 <-read.csv("../Split_Data2/test_2010.csv")
test1 <- test1[myvars]
test1$GRAD <- as.factor(test1$GRAD)
test1$CHECK <- as.numeric(test1$CHECK)
#test1$CLASS_OF <- as.factor(test1$CLASS_OF)
test2 <-read.csv("../Split_Data2/test_2011.csv")
test2 <- test2[myvars]
test2$GRAD <- as.factor(test2$GRAD)
test2$CHECK <- as.numeric(test2$CHECK)
#test2$CLASS_OF <- as.factor(test2$CLASS_OF)
test3 <-read.csv("../Split_Data2/test_2012.csv")
test3 <- test3[myvars]
test3$GRAD <- as.factor(test3$GRAD)
test3$CHECK <- as.numeric(test3$CHECK)
#test3$CLASS_OF <- as.factor(test3$CLASS_OF)
test4 <-read.csv("../Split_Data2/test_2013.csv")
test4 <- test4[myvars]
test4$GRAD <- as.factor(test4$GRAD)
test4$CHECK <- as.numeric(test4$CHECK)
#test4$CLASS_OF <- as.factor(test4$CLASS_OF)
test5 <-read.csv("../Split_Data2/test_2014.csv")
test5 <- test5[myvars]
test5$GRAD <- as.factor(test5$GRAD)
test5$CHECK <- as.numeric(test5$CHECK)
#test5$CLASS_OF <- as.factor(test5$CLASS_OF)
cluster1 <- kmeans(train1[,1:dim(train1)[2]-1], 2, nstart = 20)
pred <-cluster1$cluster
tabletrain1 <-table(cl_predict(cluster1, train1[1:length(myvars)-1]), train1$GRAD)
tabletest1 <-table(cl_predict(cluster1, test1[1:length(myvars)-1]), test1$GRAD)
train1 <- read.csv("../Split_Data2/training[1].csv")
new <- cbind (train1, pred)
write.csv(new, file = "kmeanstrain1.csv")
tabletrain1
tabletrain2
tabletrain1
cluster2 <- kmeans(train2[,1:dim(train2)[2]-1], 2, nstart = 20)
pred <-cluster2$cluster
tabletrain2 <-table(cl_predict(cluster2, train2[1:length(myvars)-1]), train2$GRAD)
tabletest2 <-table(cl_predict(cluster2, test2[1:length(myvars)-1]), test2$GRAD)
train2 <- read.csv("../Split_Data2/training[2].csv")
new <- cbind (train2, pred)
write.csv(new, file = "kmeanstrain2.csv")
cluster3 <- kmeans(train3[,1:dim(train3)[2]-1], 2, nstart = 20)
pred <-cluster3$cluster
tabletrain3 <-table(cl_predict(cluster3, train3[1:length(myvars)-1]), train3$GRAD)
tabletest3 <-table(cl_predict(cluster3, test3[1:length(myvars)-1]), test3$GRAD)
train3 <- read.csv("../Split_Data2/training[3].csv")
new <- cbind (train3, pred)
write.csv(new, file = "kmeanstrain3.csv")
cluster4 <- kmeans(train4[,1:dim(train4)[2]-1], 2, nstart = 20)
pred <-cluster4$cluster
tabletrain4 <-table(cl_predict(cluster4, train4[1:length(myvars)-1]), train4$GRAD)
tabletest4 <-table(cl_predict(cluster4, test4[1:length(myvars)-1]), test4$GRAD)
train4 <- read.csv("../Split_Data2/training[4].csv")
new <- cbind (train4, pred)
write.csv(new, file = "kmeanstrain4.csv")
cluster5 <- kmeans(train5[,1:dim(train5)[2]-1], 2, nstart = 20)
pred <-cluster5$cluster
tabletrain5 <-table(cl_predict(cluster5, train5[1:length(myvars)-1]), train5$GRAD)
tabletest5 <-table(cl_predict(cluster5, test5[1:length(myvars)-1]), test5$GRAD)
train5 <- read.csv("../Split_Data2/training[5].csv")
new <- cbind (train5, pred)
write.csv(new, file = "kmeanstrain5.csv")
tabletrain1
tabletrain2
tabletrain3
tabletrain4
tabletrain5
tabletest1
tabletest2
tabletest3
tabletest4
tabletest5
data("Cassini")
pcl <- kmeans(Cassini$x, 3)
is.cl_partition(pcl)
is.cl_hard_partition(pcl)
is.cl_soft_partition(pcl)
library(pvclust)
fit <- pvclust(train5, method.hclust="ward", method.dist="euclidean")
pvrect(fit, alpha=.95)
